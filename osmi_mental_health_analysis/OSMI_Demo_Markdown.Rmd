---
title: "OSMI Analysis Demographics Markdown"
author: "Ryan Chiu"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introduction
This R Markdown document is intended to demonstrate to shareholders how the OSMI Mental Health Dataset was analyzed to obtain the findings and graphs presented in the analysis. The document guides readers through the entire data analysis process, from cleaning data to the plotting of variables.

# 1. Data Cleaning

## 1.1 Setup

First, the relevant libraries need to be loaded for use later on. Key libraries include "readr" (to read CSV files), "tidyverse" (to clean data), and "ggplot2" (to visualize data).

```{r setup library, message = FALSE}
library(tidyr)
library(tidyverse)
library(readr)
library(ggplot2)
library(dplyr)
library(janitor)
library(gridExtra)
```
```{r setwd, include = FALSE}
setwd("C:/Users/ryany/OneDrive/Desktop/Google Data Analytics R Files")
```

## 1.2 Loading Data into RStudio
We can now load in the CSV file and view the survey data that was gathered by OSMI
```{r load_csv, message = FALSE}
osmi_2022 <- read_csv("OSMI_2022.csv")
head(osmi_2022)
```
As we can see, the column names appear to be the survey questions as well as some variables related to the survey itself (e.g., unique participant ID numbers). We can now proceed with cleaning the data table

## 1.3 Cleaning Data Table
The first issue in cleaning up the data table is to rename the column names such that they are more descriptive and concise compared to just the survey question itself. Here, I have used snake-case names with enough descriptive features to get a sense of what the original questions are; a more structured method would be to use alphanumeric identifiers instead (e.g., Q1, Q2, etc.) and to link those identifiers to the actual survey questions in a separate document. Such an approach would probably be most ideal when collaborating with colleagues on the same document.
```{r colnames}
colnames(osmi_2022) <- c("id", "self_employed", "company_size", 
                         "tech_company", "tech_role_primary", "mh_coverage", 
                         "mh_options_aware", "mh_employer_discuss", "mh_resource_employer_offer", 
                         "anon_protect", "mh_leave_difficulty", "mh_ph_discuss_coworker",
                         "comfort_supervisor", "mh_employer_discuss_personal", 
                         "description_mh_employer_discuss_personal",
                         "comfort_coworker", "mh_coworker_discuss_personal", 
                         "description_mh_coworker_discuss_personal",
                         "mh_coworker_discuss_personal_2", "description_mh_coworker_discuss_personal_2", 
                         "ph_employer_importance", 
                         "mh_employer_importance", "mh_personal_coverage", "mh_resource_aware", 
                         "mh_reveal_client", "mh_reveal_client_outcome", "mh_reveal_coworkers", 
                         "mh_reveal_coworkers_outcome", "mh_productivity", "mh_productivity_worktime",
                         "prev_employer", "prev_employer_tech_company", "mh_coverage_prev_employer",
                         "mh_options_aware_prev_employer", "mh_prev_employer_discuss", 
                         "mh_resource_prev_employer_offer", 
                         "anon_protect_prev_employer", "comfort_prev_employer", "comfort_prev_supervisor", 
                         "mh_prev_employer_discuss_personal", "description_mh_prev_employer_discuss_personal", 
                         "comfort_prev_coworker",
                         "mh_prev_coworker_discuss_personal", "description_mh_prev_coworker_discuss_personal", 
                         "mh_prev_coworker_discuss_personal_2",
                         "description_mh_prev_coworker_discuss_personal_2", "ph_prev_employer_importance", 
                         "mh_prev_employer_importance", 
                         "mh_current_diag", "mh_diag_history","diag_anxiety_disorder", 
                         "diag_mood_disorder", "diag_psychotic_disorder", "diag_eating_disorder", 
                         "diag_adhd_disorder", "diag_personality_disorder", "diag_ocd_disorder", 
                         "diag_ptsd_disorder", "diag_stress_disorder", "diag_did_disorder", 
                         "diag_sud_disorder", "diag_addiction_disorder", "diag_other_disorder", 
                         "possible_anxiety_disorder", "possible_mood_disorder", "possible_psychotic_disorder",
                         "possible_eating_disorder", "possible_adhd_disorder", "possible_personality_disorder", 
                         "possible_ocd_disorder", "possible_ptsd_disorder", "possible_stress_disorder", 
                         "possible_did_disorder","possible_sud_disorder", "possible_addiction_disorder", 
                         "possible_other_disorder", "past_anxiety_disorder", "past_mood_disorder", 
                         "past_psychotic_disorder", "past_eating_disorder", "past_adhd_disorder", 
                         "past_personality_disorder", "past_ocd_disorder", "past_ptsd_disorder", 
                         "past_stress_disorder", "past_did_disorder", "past_sud_disorder", 
                         "past_addiction_disorder", "past_other_disorder", "mh_past_diag", 
                         "mh_disorder_treat","mh_fam_hist", "mh_work_disrupt_treated", 
                         "mh_work_disrupt_untreated", "mh_other_discuss_bad_reveal", "mh_diag_share_fam_friends", 
                         "ph_discuss_potential_employer", "ph_discuss_potential_employer_why", 
                         "mh_discuss_potential_employer", 
                         "mh_discuss_potential_employer_why", "mh_openid", "mh_openid_outcome", 
                         "mh_openid_outcome_description", "mh_perceived_rx", "mh_observe_bad_rx", 
                         "mh_observe_bad_rx_description", "mh_observe_good_rx", "mh_observe_good_rx_description", 
                         "mh_perceived_industry_support", "mh_industry_support_suggestion", "add_comments", 
                         "follow_up", "age", "gender", 
                         "country_res", "us_state_res", "race", 
                         "race_other", "country_work", "us_state_work", 
                         "covid_diag", "start_date", "submit_date",
                         "network_id")
```

Some of the questions were repeated several times intentionally. For example, the questions "If possibly, what disorders do you believe you have?" and "If so, what disorders were you diagnosed with?" asks whether the participant believes they currently have a mental disorder and whether their clinical diagnosis history respectively. Additionally, the answers to those questions were listed as their own columns in the CSV file. As the dataset does not clarify the context of such questions, I used the [OSMI's basic report](https://osmi.typeform.com/report/Fja7Jb9K/t5F4sKEyeGhGgU7V) of the data to figure out which of the column names were related to which questions.

The next step is to filter out any columns that are not necessary for any of the data analysis, such as the participant identifiers, network ID numbers, and survey date.

```{r, results = FALSE}
osmi_select <- osmi_2022 %>% 
  select(-id, -follow_up, -start_date,
         -submit_date, -network_id)
```

As mentioned previously, some of the questions' answers were their own columns. Therefore, we placed all those columns together into a single column representing the actual question being asked by using the *unite* function. By setting the *na.rm* argument as true, we are able to eliminate any blank spaces (indicating the participant did not select that answer).
```{r}
osmi_unite <- osmi_select %>% 
  unite("diag_disorder", diag_anxiety_disorder, 
        diag_mood_disorder, diag_psychotic_disorder, diag_eating_disorder, 
        diag_adhd_disorder, diag_personality_disorder, diag_ocd_disorder, 
        diag_ptsd_disorder, diag_stress_disorder, diag_did_disorder, 
        diag_sud_disorder, diag_addiction_disorder, diag_other_disorder,
        sep = "", na.rm = TRUE) %>% 
  unite("possible_disorder",  possible_anxiety_disorder, possible_mood_disorder, possible_psychotic_disorder,
        possible_eating_disorder, possible_adhd_disorder, possible_personality_disorder, 
        possible_ocd_disorder, possible_ptsd_disorder, possible_stress_disorder, 
        possible_did_disorder,possible_sud_disorder, possible_addiction_disorder, 
        possible_other_disorder, sep = "", na.rm = TRUE) %>% 
  unite("past_disorder", past_anxiety_disorder, past_mood_disorder, 
        past_psychotic_disorder, past_eating_disorder, past_adhd_disorder, 
        past_personality_disorder, past_ocd_disorder, past_ptsd_disorder, 
        past_stress_disorder, past_did_disorder, past_sud_disorder, 
        past_addiction_disorder, past_other_disorder, sep = "", na.rm = TRUE) %>% 
  unite("race", race, race_other, na.rm = TRUE)
```

A concern regarding the dataset was the possibility of having in the data in incorrect data types. To check this, we used the *str* function (for conciseness, we limited the output here to the first 6 rows).
```{r}
str(osmi_unite, list.len = 6)
```

Some of the variables clearly were in the incorrect data type. For example, the variable "tech_company" is a binary yes/no question in which the participant indicates whether their company is predominantly a tech company, making it more suitable as a boolean/logical data type. Thus, we converted the data types of these columns into their appropriate formats.

```{r}
osmi_str <- osmi_unite %>% 
  mutate(self_employed = as.logical(self_employed),
         tech_company = as.logical(tech_company),
         tech_role_primary = as.logical(tech_role_primary),
         mh_employer_discuss_personal = as.logical(mh_employer_discuss_personal),
         mh_coworker_discuss_personal = as.logical(mh_coworker_discuss_personal),
         mh_coworker_discuss_personal_2 = as.logical(mh_coworker_discuss_personal_2),
         mh_personal_coverage = as.logical(mh_personal_coverage),
         prev_employer = as.logical(prev_employer),
         prev_employer_tech_company = as.logical(prev_employer_tech_company),
         mh_prev_employer_discuss_personal = as.logical(mh_prev_employer_discuss_personal),
         mh_prev_coworker_discuss_personal = as.logical(mh_prev_coworker_discuss_personal),
         mh_prev_coworker_discuss_personal_2 = as.logical(mh_prev_coworker_discuss_personal_2),
         mh_disorder_treat = as.logical(mh_disorder_treat),
         mh_openid = as.logical(mh_openid),
         mh_openid_outcome = as.logical(mh_openid_outcome),
         mh_observe_good_rx_description = as.character(mh_observe_good_rx_description))
str(osmi_str, list.len = 6)
```

Notice how tech_company is now a logical variable, verifying that the format of the data has been changed correctly.

Upon viewing the dataset at this point, we noticed that there were 2 variables, "country_work" (country participant works in) and "country_res" (country participant resides in), that are similar to each other. To determine whether any participants had a country of work that was not the same as their country of residence we utilized a *filter* function.

```{r}
osmi_work_res_diff <- osmi_str %>% 
  select(country_res, country_work) %>% 
  filter(country_res != country_work)
osmi_work_res_diff
```

We noticed that there are 3 participants whose work country was not the same as their country of residence. However, since this analysis was restricted to participants within America, we can ignore these observations as they will not be included regardless. On a related note, we can proceed with filtering out the dataset to contain only American respondents.

```{r}
osmi_us <- osmi_str %>% 
  filter(country_res == "United States of America",
         tech_company == TRUE)
head(osmi_us)
```

At this point, a significant portion of the data table has been cleaned, and we can now proceed with the analysis and visualization of data. Some of the columns require further cleaning, but due to the exploratory nature of the analysis, not all variables will be used; therefore, we decided to clean the individual columns somewhat simultaneously with the analysis to prevent unnecessary cleaning of unused variables and improve efficiency.

***

# 2. Demographic Statistics

## 2.1 Creating Data Subset
The most intuitive starting point for a data analysis, particularly in healthcare research, is to examine the demographic characteristics of the sample. We can first create a subset of the data that only includes demograhpic variables for a more manageable and relevant data table. We can use the *select* function to only include our variables of interest.

```{r}
osmi_demo <- osmi_us %>% 
  select("self_employed", "company_size", "tech_company", 
         "tech_role_primary", "age", "gender", 
         "us_state_res", "race", 
         "us_state_work", "covid_diag")
head(osmi_demo)
```

With our subset created, we can now proceed with analysis and visualization of the relevant demographic variables.

## 2.2 Plotting Demographic Statistics

### 2.2.1 Exclusion of Demographic Variables
Upon viewing the **osmi_demo** subset, two observations were made. First, the "covid_diag" variable had virtually no responses from the American particiapnts, rendering it impossible to analyze. Second, much like the issue earlier regarding "country_work" and "country_res", the variables "us_state_res" (state of residence) and "us_state_work" (state of work) are far too similar to warrant separate analyses. Therefore, we decided to use the participant's state of residence for demographic analyses. In summary, we removed "covid_diag" and "us_state_work" variables from further analyses.

### 2.2.2 Plotting Self-Employed Status
We can use the *ggplot* package to visualize the data given. In the case of self-employed status, we can use the *ggplot* function to create a graph for the variable of interest. By setting "self_employed" to the *fill* argument, we are able to create a stacked column graph, with which we can add the *coord_polar* function to convert it into a pie chart. We can also use the *after_stat* function, we can convert the counts of each unique response (i.e., zeroes, ones indicating no or yes respectively) into a percentage, as well as combining this with the *paste0* function inside the *geom_text* function to create percentage labels. Lastly, we used *scale_fill_discrete* to relabel the numeric binary values into descriptive labels (i.e., "No")
```{r}
osmi_self <- osmi_demo %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = self_employed)) +
  geom_bar() +
  geom_text(aes(label = paste0(after_stat(100*count/sum(count)), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") + 
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Self-Employed Status") +
  scale_fill_discrete(labels = "No")
osmi_self
```

As can be seen, all American respondents were not self-employed; presumably, then, they would be employees of a tech company.

### 2.2.3 Plotting Company Size
We can continue to use the ggplot package to visualize the rest of the data. Looking at the "company_size" variable, we noticed that some of the responses were incorrectly converted into dates (e.g., the response "1-5" was converted to "05 Jan"). Thus, we used the *replace* function to convert those responses into the correct format.
```{r}
osmi_demo$company_size <- replace(osmi_demo$company_size, 
                                  osmi_demo$company_size == "05-Jan", 
                                  "1-5")
osmi_demo$company_size <- replace(osmi_demo$company_size, 
                                  osmi_demo$company_size == "25-Jun", 
                                  "6-25")
```

Similar to self-employed status, now that the data is cleaned we can use *ggplot* to graph our data.
```{r}
osmi_comp_size <- osmi_demo %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = company_size)) +
  geom_bar() + 
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") + 
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Respondent's Company Size") +
  scale_fill_discrete(labels = c("1-5", "100-500", "26-100", 
                                 "500-1000", "6-25", "More than 1000", "No Answer"))
osmi_comp_size
```

The graph shows that just over half of the respondents were in a small tech company with 6-25 employees, around 15% of respondents belonged to larger companies with more than 100 employees, nearly one-fifth of the sample worked at companies with no more than 5 employees, and roughly 15% of respondents were in mid-sized companies with 26-100 employees.

### 2.2.4 Plotting Job Classification
```{r}
osmi_tech_role <- osmi_demo %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = tech_role_primary)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") + 
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Respondent's Job Type") +
  scale_fill_discrete(labels = c("Non-Tech", "Tech", "No Answer"))
osmi_tech_role
```

The "tech_role_primary" variable indicates whether the respondent's job is primarily tech-related or not. Since the entire sample will be used for subsequent analyses, we decided to keep blank responses and classify them as "No Answer". The results indicate that just over four-fifths of the sample are indeed working tech-dominant roles within their companies, whilst the rest worked non-tech jobs.

### 2.2.5 Plotting Age Distribution
While skimming through the "age" column, we noticed that there was one respondent who listed their age as "223". As this is clearly a typo (pressing "2" twice instead of once), we manually corrected the typo using the *replace* function.
Due to the nature of the "age" variable, it is more appropriate to use a histogram to display such data as opposed to a bar or pie chart. We can use the *geom_histogram* function to create a histogram plot, using the *binwidth* argument to determine how the values should be grouped.
```{r}
osmi_demo$age <- replace(osmi_demo$age, 
                         osmi_demo$age == 223,
                         23)

osmi_age <- osmi_demo %>% 
  ggplot(aes(x = age, y = after_stat(100*count/sum(count)))) +
  geom_histogram(color = 4, fill = 5, binwidth = 5) +
  labs(x = "Age", y = "Percentage", title = "Age Distribution of Respondents")
osmi_age
```

The results show that the large majority of respondents are aged between 27-43 years old. A few respondents were around 50 years old, and around 12% of participants were in their mid-twenties.

### 2.2.6 Plotting Gender Distribution
```{r}
osmi_distinct <- osmi_demo %>% 
  distinct(gender)
osmi_distinct
```
The question asking about the participant's gender appeared to be an open-ended response instead of a multiple choice format, resulting in multiple entries indicating one specific gender (e.g., "female" and "F"). Therefore, we used the *distinct* and *replace* function to combine all the different answers into uniform responses indicating one of three options: male, female, and non-binary.
```{r}
osmi_demo$gender <- replace(osmi_demo$gender,
                            osmi_demo$gender %in% c("female", "Female (cis)", "woman", "F"),
                            "Female") 
osmi_demo$gender <- replace(osmi_demo$gender,
                            osmi_demo$gender %in% c("male","male/he/him", "cis-het male", "M"),
                            "Male")
osmi_demo$gender <- replace(osmi_demo$gender,
                            osmi_demo$gender %in% c("afab non-binary","Non-binary/Agender"),
                            "Non-Binary")

osmi_gender <- osmi_demo %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = gender)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") + 
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Gender of Respondent") +
  scale_fill_discrete(labels = c("Female", "Male", "Non-Binary"))
osmi_gender
```

The results show that between binary genders, the distribution was quite even at roughly 45% of respondents identifying as either male or female. Nearly one-tenth of the sample identified as non-binary.

### 2.2.7 Plotting Ethnic Distribution
```{r}
osmi_race <- osmi_demo %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = race)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") + 
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Race of Respondent") +
  scale_fill_discrete(labels = c("Asian", "Multi-racial (unspecified)", "White"))
osmi_race
```

The data shows that two-thirds of the respondents identified as Caucasian, whilst nearly one-third of repsondents identified as Asian. A small proportion of the sample identified as multi-racial.

### 2.2.8 Plotting State of Residence
For this variable, because the state names are so long, we decided to use the *coord_flip* function to flip the graph 90 degrees, resulting in a sidways bar graph that provides enough space for the state names on the x-axis.
```{r}
osmi_state <- osmi_demo %>% 
  ggplot(aes(x = us_state_res, y = after_stat(100*count/sum(count)))) +
  geom_bar(fill = 4) +
  coord_flip() +
  labs(x = "State", y = "Percentage", title = "Respondents' State of Residence")
osmi_state
```

The data shows that 16 different states were represented in the sample, with more respondents coming from California, North Carolina, New York, and (to a slight extent) Maryland.

## 2.3 Summary of Plots
With 7 plots in total, there is a lot of information here to process and present. For ease of presentation, we can use the *grid.arrange* function in the *gridExtra* library to present multiple charts simultaneously. We can then export this summary page to the file format of our choice for presentation in, for example, a PowerPoint presentation.
```{r, fig.height = 10, fig.width = 15}
grid.arrange(osmi_self, osmi_comp_size, osmi_tech_role, 
             osmi_age, osmi_gender, osmi_race, 
             osmi_state,
             ncol = 3)
```

## 2.4 Comments and Remarks
Demographic characteristics usually do not warrant further discussion provided the sample is representative of the population. However, the sample size is noticeably small, with a size of n = 27. This is less than the minimum recommended sample size (30) that usually indicates a representative sample. As such, our conclusions based off the data may not be the most reliable, and will likely require further research. With regards to the sample size, we can confirm this by using the *nrow* function to count how many rows (and therefore observations) our US subset contains.
```{r}
nrow(osmi_us)
```

# 3. Prevalence of Mental Health Disorders in the Tech Industry

## 3.1 Determining Suitable Variables for Analyzing Mental Health Disorder Prevalence
With so many variables in the OSMI survey, we had to determine which variables would best provide us with information regarding how prevalent mental health issues were in the tech industry workplace. Skimming through the dataset, we concluded that the following variables were appropriate: "mh_current_diag" (whether respondents were currently diagnosed with a mental health disorder); "mh_diag_history" (whether respondents had been diagnosed with a mental health disorder in the past), "past_disorder" (the specific mental health disorder the respondent was diagnosed with in the past); and "mh_disorder_treat" (whether respondents had ever sought treatment for a mental health disorder). Some other variables could not be included in the analysis due to its unsuitability (e.g., "possible_disorder", which provides information on the perceived mental health disorer respondents believe they have, had only 2 responses).

## 3.2 Plotting Mental Health Prevalence Data

### 3.2.1 Plotting Current and Past Mental Health Disorder Prevalence
```{r, fig.width = 10}
osmi_diag <- osmi_us %>% 
  drop_na(mh_current_diag) %>% 
  ggplot(aes(x = mh_current_diag, y = after_stat(100*count/sum(count)))) +
  geom_bar(fill = 4) + 
  labs(x = "Diagnosed with MH Disorder", y = "Percentage", title = "Presently Diagnosed with Mental Health Disorder")

osmi_diag_past <- osmi_us %>% 
  drop_na(mh_diag_history) %>% 
  ggplot(aes(x = mh_diag_history, y = after_stat(100*count/sum(count)))) +
  geom_bar(fill = 4) +
  labs(x = "Had MH Disorder", y = "Percentage", title = "Previously Diagnosed with Mental Health Disorder")

grid.arrange(osmi_diag, osmi_diag_past, ncol = 2)
```

The visualization process, much like Section 2.3, combines the *ggplot* with *grid.arrange* functions to visualize and present multiple plots together to convey related and critical information. The data shows that a significant proportion of the sample (over 60%) reported having a mental health disorder at the time of the survey, with just over one-fifth of respondents declaring being completely (mentally) healthy. Nearly 10% of the sample perceive themselves as having a mental health disorder, but are unsure or have not been officially diagnosed yet. Furthermore, almost the entire surveyed sample reported having been previously diagnosed with a mental health disorder.

### 3.2.2 Plotting Mental Health Disorder Classification
```{r}
osmi_diag_type <- osmi_us %>% 
  drop_na(past_disorder) %>% 
  distinct(past_disorder)
osmi_diag_type
```

Calling the "past_disorder" column in the US data subset reveals that there were multiple different responses that may hinder data analysis. The answers were clearly part of a multiple choice list, however certain responses (e.g., row 4) suggest that multiple answers could be selected; this could potentially make interpreting the data in its original form quite hard (e.g., a respondent may answer having a mood and anxiety disorder, another respondent having anxiety and post-traumatic stress disorder, resulting in a number of categories/unique responses that could number in the double digits). To process this data for readability, we first utilized *mutate* to to create a column counting the number of characters for each response, followed by *arrange* to sort the answers by increasing character count.

```{r}
osmi_diag_type <- osmi_us %>% 
  drop_na(past_disorder) %>% 
  distinct(past_disorder) %>% 
  mutate(past_disorder_char = nchar(past_disorder)) %>% 
  arrange(past_disorder_char) 
osmi_diag_type
```

The resulting table allowed us to note that the answer indicating a **single** mental health disorder with the most text contained 56 characters (row 4), whereas all answers indicating **multiple** disorders contained more than 56 characters (row 5 onwards). Using this information, we can then utilize the *case_when* function inside the *mutate* function to convert all answers containing more than 56 characters into a single, uniform response of "Comorbid/Multiple Disorders", then plot the transformed data using *ggplot*. Note that we used the *filter* function to remove blank responses as we ascertained that these respondents answers "No" when asked whether they were previously diagnosed with a mental health disorder.

```{r}
osmi_diag_type_graph <- osmi_us %>%
  drop_na(past_disorder) %>% 
  filter(past_disorder != "") %>% 
  mutate(past_disorder = case_when(
    nchar(past_disorder) > 56 ~ "Comorbid/Multiple Disorders",
    nchar(past_disorder) == 25 ~ "Stress Response Syndromes",
    nchar(past_disorder) == 49 ~ "Mood Disorder (Depression, Bipolar Disorder, etc)",
    nchar(past_disorder) == 56 ~ "Psychotic Disorder (Schizophrenia, Schizoaffective, etc)")) %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = past_disorder)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") + 
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Past Mental Health Disorder History")
osmi_diag_type_graph
```

The data shows that of the respondents who identified as having been previously diagnosed with a mental health disorder, roughly three quarters identified as having comorbid (i.e., multiple) disorders. The second most common disorder were mood disorders (e.g., depression), with psychotic (e.g., schizophrenia) and stress disorders being tied for the third most common disorder. This signifies that most mentally ill individuals in the sample often have the burden of struggling with more than one mental health disorder.

### 3.2.3 Plotting Treatment Staus of Mental Health Disorders
```{r}
osmi_treated <- osmi_us %>% 
  drop_na(past_disorder) %>% 
  filter(past_disorder != "") %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = mh_disorder_treat)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  scale_fill_discrete(label = "Yes") +
  coord_polar(theta = "y") + 
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Whether Mental Health Disorder was Treated")
osmi_treated
```

The data shows that all individuals who had a mental health disorder sought treatment, a data point worth further discussion (see below).

## 3.3 Summary of Plots

Much like Section 2.3, we can use the *grid.arrange* function to present all the created charts in Section 3 simultaneously for presentation purposes. 
```{r, fig.width = 15, fig.height = 15}
grid.arrange(osmi_diag, osmi_diag_past, 
             osmi_diag_type_graph, osmi_treated,
             ncol = 2)
```

## 3.4 Discussion

Altogether, the data suggests that the prevalence of mental health disorders in the American tech industry is abnormally high relative to the general population based on statistics from [John Hopkins](https://www.hopkinsmedicine.org/health/wellness-and-prevention/mental-health-disorder-statistics), but supports the idea that most individuals with such disorders tend to have comorbid disorders. The most common disorders globally are also reflected in the sample, with mood and psychotic disorders accounting for the majority of responses indicating a single mental health disorder. On the optimistic side, the last graph unequivocally suggests that clinical patients in the sample have sought treatment for their mental health disorders at some point in their lives, suggesting that the mental healthcare support for employees in the tech industry is adequate in terms of employees' awareness of such options. Since treatment options do not appear to be an issue, a topic worth researching is the pervasiveness of mental health disorders in the tech industry, and how to best mitigate the prevalence of such disorders in the field.

As mentioned in Section 2.4, it is important to take caution in the reliability of the conclusions made in this analysis, as the small sample size is, by nature, prone to skewing of results, and may lead to the rather extreme outcomes and observations seen in the data visualizations. Any findings made in this section should be confirmed by a replication of the survey before using them as a basis for further research.

***

# 4. Workplace Related Effects of Mental Health Issues

## 4.1 Creating a Data Subset
We can first create a subset of the US dataset by using *select* to include only relevant variables. In this case, we defined "workplace related effects" as any variables assessing the actual or perceived impacts, positive or negative, of any mental health factors on workplace productivity. These include more individual factors (e.g., having a mental health disorder and how it impacts productivity) as well as more structural factors (e.g., perceived level of mental health support in the tech industry as a whole).
```{r}
osmi_mh_effects <- osmi_us %>% 
  select(21, 56:58, 62, 64:68, 70, 72)
head(osmi_mh_effects)
```

## 4.2 Plotting Effects of Mental Health on Workplace Productivity

### 4.2.1 Plotting Perceived Workplace Disruption with Mental Health Disorder
Here, we plot the variables "mh_work_disrupt_treated" (perceived disruption of treated mental health disorders on workplace productivity) and "mh_work_disrupt_untreated" (perceived disruption of **untreated** mental health disorders on workplace productivity) together using *gird.arrange* as these variables are related to each other and can provide useful information when presented side-by-side. We also use the *filter* function to leave out answers from respondents indicating they did not have any mental health disorders (i.e., the questions were not relevant to them).

```{r, fig.width = 15, fig.height = 7}
osmi_dis_treat <- osmi_mh_effects %>% 
  filter(mh_work_disrupt_treated != "Not applicable to me") %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = mh_work_disrupt_treated)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") +
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Mental Health Disorder Perceived to Interfere with Work", subtitle = "(When Under Treatment)")

osmi_dis_untreat <- osmi_mh_effects %>% 
  filter(mh_work_disrupt_untreated != "Not applicable to me") %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = mh_work_disrupt_untreated)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") +
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Mental Health Disorder Perceived to Interfere with Work", 
       subtitle = "(When Not Treated)")

grid.arrange(osmi_dis_treat, 
             osmi_dis_untreat,
             ncol = 2)
```

The data shows that there is a major difference as to how respondents view how severe mental health disorder disrupts productivity based on treatment status. Given that the mental health disorder is treated, almost 90% of respondents believed that the mental health disorder would never, rarely, or only sometimes affect productivity. However, when assuming the mental health disorder is left untreated, roughly three quarters of the sample believed the impacts to be quite severe (i.e., disrupting work often). 

### 4.2.2 Plotting Effects of Being Openly Identified with Mental Health Disorder

Much like Section 4.2.1, we use *grid.arrange* here to plot three related variables together, "mh_openid_outcome" (perceived careeer impacts of being publicly identified with a mental health disorder in the workplace) grouped by "mh_openid" (whether respondent openly associates with a mental health disorder in the workplace) responses, as well as "mh_perceived_rx" (a coworker's reaction to the respondent being openly identified with a mental disorder in a hypothetical scenario). 
```{r}
str(osmi_mh_effects)
```

Here, some of the variables needed further cleaning. Using *str* we were able to notice that some variables were not in the correct data format. Most noticeably, "mh_perceived_rx" appeared to a question that was answered using a Likert scale, meaning that the data should be represented as an **integer** data type and not a **character** type. Thus, we used *as.integer* within the *mutate* function to convert said variable into its correct data format prior to data visualization. This is also the first time we use *drop_na*, which removes null observations, as these data points do not provide any useful insight during analysis.

In the *ggplot* function, we also used the *breaks* argument in the *scale_x_continuous* function to manually denote which values should be marked on the x-axis, indicating the minimum, middle, and maximum possible response values (0, 5, and 10 respectively). Since no respondent provided an answer of "0", we also used the *expand_limits* function to ensure the x-axis showed the minimum possible value even though no responses were recorded.

```{r, fig.width = 15, fig.height = 7}
osmi_openid <- osmi_mh_effects %>% 
  ggplot(aes(x = mh_openid, y = after_stat(100*count/sum(count)), fill = mh_openid_outcome)) +
  geom_bar() +
  labs(fill = "", x = "Openly Identified with MH Disorder", y = "Percentage", 
       title = "Being Publicly Identified with Mental Health Disorder Impacts Career") +
  scale_x_discrete(labels = c("No", "Yes")) +
  scale_fill_discrete(labels = c("No", "Yes", "Not Applicable"))

osmi_per_rx <- osmi_mh_effects %>% 
  drop_na(mh_perceived_rx) %>% 
  mutate(mh_perceived_rx = as.integer(mh_perceived_rx)) %>% 
  ggplot(aes(x = mh_perceived_rx, y = after_stat(100*count/sum(count)))) +
  geom_bar(fill = 4) +
  labs(x = "Perceived Hypothetical Reaction", y = "Percentage", 
       subtitle = "Hypothetical situation; higher Values Indicate More Positive Reaction", 
       title = "Coworker's Reaction to Respondent Having MH Disorder") +
  scale_x_continuous(breaks = c(0, 5, 10)) +
  expand_limits(x = 0)

grid.arrange(osmi_openid, 
             osmi_per_rx,
             ncol = 2)
```

The data shows that only about one quarter of the sample is openly identified in the workplace as having a mental health disorder. Of those respondents, the majority believed that their status did not affect their careers, although some respondents perceived an impact on career opportunities. When presented with a hypothetical scenario about being openly identified with a mental health disorder, the responses were somewhat normally distributed with the majority of responses centered around the median response value (5), although respondents tended to answer on the more positive side (around 60% answered with a value of 5 or greater). Together, the results suggest that a small proportion of individuals within the tech industry are openly identified as being mentally ill; however, even when openly identified, it is more likely that coworkers will react either neutrally or positively to such news. This implies that coworkers in the workplace are generally perceived as being quite tolerant and understanding of mental health issues, an observation that may apply to the work culture in America as a whole (further data required).

### 4.2.3 Plotting Perceived Industry Support
```{r}
osmi_per_ind_sup <- osmi_mh_effects %>% 
  drop_na(mh_perceived_industry_support) %>% 
  ggplot(aes(x = mh_perceived_industry_support, y = after_stat(100*count/sum(count)))) +
  geom_bar(fill = 4) +
  labs(x = "Perceived Support", y = "Percentage", 
       title = "Perceived Mental Health Support in Industry", 
       subtitle = "Higher Values Indicate Greater Support")
osmi_per_ind_sup
```

The data from the "mh_perceived_industry_support" (the respondent's opinion of how well the tech industry supports employees with mental health issues) variable suggests that most respondents believe the tech industry needs to improve how they handle mental health issues with respect to their employees. This is based off of the data which indicates around 45% of respondents perceived industry support to be at a value of less than 3, which would translate to between average to below-average quality of industrial support (assuming that the Likert scale captures a linear spectrum of responses). On the flip side, under one-fifth of the sample perceived industry support to be of above-average quality (response values of more than 3). Approximately one-third of respondents thought industry support was mediocre (response value of 3).

### 4.2.4 Plotting Instances of Workplace Mental Health Situations

The following variables, "mh_observe_bad_rx" and "mh_observe_good_rx", indicate whether the respondent ever witnessed a mental health situation that was handled either unwell or well, respectively. The options to these questions included a distinction between **witnessing** (observer) and **experiencing** (participant) a situation, as well as an option for uncertainty ("Maybe/Not sure").

```{r, fig.width = 10, fig.height = 7}
osmi_bad_rx <- osmi_mh_effects %>% 
  drop_na(mh_observe_bad_rx) %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = mh_observe_bad_rx)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") +
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Respondent Witnessed Badly Handled Mental Health Issue")

osmi_good_rx <- osmi_mh_effects %>% 
  drop_na(mh_observe_good_rx) %>% 
  ggplot(aes(x = "", y = after_stat(100*count/sum(count)), fill = mh_observe_good_rx)) +
  geom_bar() +
  geom_text(aes(label = paste0(round(after_stat(100*count/sum(count)), 2), "%")), 
            position = position_stack(vjust = 0.5), 
            stat = "count") +
  coord_polar(theta = "y") +
  theme(axis.ticks = element_blank(), 
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.title = element_blank()) +
  labs(fill = "", title = "Respondent Witnessed Well Handled Mental Health Issue")

grid.arrange(osmi_bad_rx, 
             osmi_good_rx,
             ncol = 2)
```

The data suggests that there may be no significant differences in how respondents answered to either question. In both cases, one-third of respondents did not witness a badly or well handled mental health issue. With regards to badly handled situations, around 45% of the sample reported being uncertain about whether they witnessed such an incident, whilst approximately one-fifth of the sample reported either having observed or experienced such an event. In terms of well handled mental health issues, roughly 40% of respondents either observed or experienced a well handled mental health problem, while about one quarter of the sample was uncertain about witnessing such an incident. 

The data does not suggest a significant pattern in answers across the two variables, suggesting they may not be related to each other (i.e., answering one of the questions does not predict a certain response in the other). Only comparative (and not correlational) observations can, therefore, be made about the results. First, more respondents see positive mental health related interactions in the workplace as compared to negative ones. This suggests that, with respect to more public mental health situations, coworkers and employers tend to resolve such problems in a satisfactory way. Second, a significant portion of respondents (especially for badly handled issues) answered as possibly having witnessed a mental health issue event that was resolved positively and/or negatively. This slightly confounds the findings and conclusions made about the data, as we do not have enough information to make conclusions about those responses (e.g, as to whether the event they are referring to is mental health related to begin with, or whether they were uncertain as to whether the outcome was positive or negative). Further research should seek to qualify or quantify the nature of participants' uncertainty (e.g., open-ended text response with thematic analysis and coding of answers).

### 4.2.5 Plotting Employer's Level of Importance Placed on Mental Health

The following variable, "mh_employer_importance", assesses the how much the respondent perceives their employer to value mental health.
```{r}
osmi_emp_mh_imp <- osmi_mh_effects %>% 
  drop_na(mh_employer_importance) %>% 
  ggplot(aes(x = mh_employer_importance, y = after_stat(100*count/sum(count)))) +
  geom_bar(fill = 4) +
  labs(x = "Employer Values MH", y = "Percentage", 
       subtitle = "Higher Values Indicate Greater Importance", title = "Employer Perceived to Value Mental Health") +
  scale_x_continuous(breaks = c(0, 5, 10)) +
  expand_limits(x = c(0, 10))
osmi_emp_mh_imp
```

The data shows that the response distribution was quite even, although  most respondents indicated believing that their employer placed an average amount of importance on mental health (5- and 6-point ratings accounting for over 40% of responses). The wide range of responses, coupled with the observation that each response value had almost the same proportion of observations*, suggests that no trend as to whether employers appear to value mental health; some employers are perceived not to value mental health very much, some employers are the opposite, and most employers may appear to value mental health equally with other aspects such as physical health.

*Note that the jump in response proportions (e.g., ~12% for rating value 1 as compared to ~7.5% for rating value 2) is insignificant due to the small sample size; since n = 27, each respondent accounts for ~3.7% of the sample. In the example above, then, the roughly 4.5% difference in response equates to about a difference of only 1-2 respondents.

### 4.2.6 Summary of Plots

Just like before, we can use *grid.arrange* to present all plots together for exporting and presentation purposes.
```{r, fig.width = 10, fig.height = 15}
grid.arrange(osmi_dis_treat, osmi_dis_untreat, osmi_openid, 
             osmi_per_rx, osmi_bad_rx, osmi_good_rx, 
             osmi_emp_mh_imp, osmi_per_ind_sup,
             ncol = 2)
```

### 4.2.7 Discussion
The variables analyzed in this Section provide some insight into how the sample perceives mental health issues to affect workplace conditions and/or work performance. First, the data shows that work productivity is perceived to be affected if a mental health disorder is left untreated (Section 4.2.1). These results suggest that respondents greatly value mental health treatment, and also believe that treatment can affect their work productivity. Together, the data implies that mental healthcare is of great value at both the individual level (e.g., perceived and/or real benefits) and the organizational level (i.e., improved mental health status may result in indirect improvements to work efficiency and performance). Further longitudinal research could evaluate objective measures of work performance pre- and post-treatment to support these findings.

Second, a small proportion of employees in the tech industry are openly identified as being mentally ill in their workplace, yet the majority of these employees don't believe that their status impacts their career prospects. Additionally, given a hypothetical scenario, a slight majority believed that a coworker would react neutrally or positively when learning that they had a mental health disorder (Section 4.2.2). These findings imply that coworkers in the workplace are generally perceived as being quite tolerant and understanding of mental health issues, an observation that may apply to the work culture in America as a whole (further data required).

Third, a huge majority of respondents believe that mental health support in the tech industry is at an average or worse level (Section 4.2.3). These initial findings warrant further investigation into why respondents believe mental health support is inadequate through interviews and qualitative analysis of data, or through quantitative analysis of variables that could potentially reflect mental health support in industry (e.g., extent of mental health coverage benefits as monetary values).

Fourth, there were no clear trends between witnessing a badly handled mental health situation and witnessing a well handled mental health situation in the workplace (Section 4.2.4). The data does not suggest a significant pattern in answers across the two variables, suggesting they may not be related to each other (i.e., answering one of the questions does not predict a certain response in the other). Only comparative (and not correlational) observations can, therefore, be made about the results. More respondents see positive mental health related interactions in the workplace as compared to negative ones, suggesting that with respect to more public mental health situations, coworkers and employers tend to resolve such problems in a satisfactory way. A limitation of the data is that a significant portion of respondents (especially for badly handled issues) answered as possibly having witnessed a mental health issue event that was resolved positively and/or negatively. but were unsure or uncertain. This slightly confounds the findings and conclusions made about the data, as we do not have enough information to make conclusions about those responses (e.g, as to whether the event they are referring to is mental health related to begin with, or whether they were uncertain as to whether the outcome was positive or negative). Further research should seek to qualify or quantify the nature of participants' uncertainty (e.g., open-ended text response with thematic analysis and coding of answers).

Finally, the majority of employers in the workplace are perceived as placing an average or moderate amount of emphasis on mental health (Section 4.2.5). These findings suggest that research and applied projects can be conducted to improve employers' view of mental health as an issue worth addressing, as we have seen previously that mental health issues, just like physical health, can impact one's productivity in the long run. 

***

# 5. Interpersonal Comfort Discussing Mental Health in the Workplace

## 5.1 Creating a Data Subset

As with before, we can first create a subset of the US dataset by using *select* to include only relevant variables. Here, we were interested in investigating how workplace conditions, as it pertains to mental health, might be related with a willingness to discuss a topic that for some may be considered a stigma or taboo. We found two suitable dependent variables, both related to the willingness to discuss mental health with employees or employers ("comfort_coworker" and "comfort_supervisor" respectively), in addition to variables that we believe may point towards a company's approach to mental health issues (e.g., "mh_coverage" determines whether the respondent's company provides medical coverage for mental health problems).

Note that in this line of code, we have used the column numbers as opposed to the variable names for conciseness. Furthermore, we have dropped any observations that did not include a response to either "comfort_supervisor" or "comfort_coworker", our "outcome" variables for analysis.
```{r}
osmi_comfort <- osmi_us %>% 
  select(5:13, 15:16, 18) %>% 
  drop_na(comfort_supervisor, comfort_coworker)
head(osmi_comfort)
```

## 5.2 Plotting Workplace Variables Grouped By Comfort Discussing Mental Health

The following graphs will be presented in pairs as each workplace condition/variable is plotted twice (once against each of our "outcome" variables). 

### 5.2.1 Plotting Mental Health Coverage

Before plotting "mh_coverage" (indicating whether the respondent's mental health treatments are covered by their company), it must first be recognized that the answers can be thought of as being somewhat ordinal in nature; a "not applicable" response (value "Not eligible for coverage / NA"), followed by a "low" value ("No"), a "medium" value ("I don't know", reflecting a possibility of having coverage), and a "high" value ("Yes"). Therefore, we can use the *factor* function to arrange "mh_coverage" responses in an ordered fashion, then follow up with *ggplot* to visualize the data in an intuitive way combined with *grid.arrange* to present both plots together.

```{r, fig.width = 15, fig.height = 10}
osmi_comfort$mh_coverage <- factor(osmi_comfort$mh_coverage, order = TRUE, 
                                           levels = c("Not eligible for coverage / NA", "No", "I don't know", "Yes"))

osmi_cov_com_cow <- osmi_comfort %>% 
  drop_na(mh_coverage) %>% 
  ggplot(aes(x = mh_coverage, y = after_stat(100*count/sum(count)), fill = comfort_coworker)) +
  geom_bar() +
  labs(x = "MH Coverage", y = "", fill = "", title = "Comfort Discussing Mental Health with Coworker")
osmi_cov_com_cow

osmi_cov_sup <- osmi_comfort %>% 
  drop_na(mh_coverage) %>% 
  ggplot(aes(x = mh_coverage, y = after_stat(100*count/sum(count)), fill = comfort_supervisor)) +
  geom_bar() +
  labs(x = "MH Coverage", y = "Percentage", fill = "", 
       title = "Comfort Discussing MH with Supervisor")
osmi_cov_sup

grid.arrange(osmi_cov_com_cow,
             osmi_cov_sup,
             ncol = 2)
```

The data suggests a trend in whether respondents are comfortable discussing mental health with colleagues and supervisors in the workplace as a function of whether mental health coverage is provided by their company. In companies that provide mental health coverage, a large proportion of employees answered as being comfortable discussing mental health topics with their coworkers and supervisors (over 50% of the responses in the "Yes" group on the x-axis). This is compared to respondents' who either are unsure about, or do not have, mental health coverage; here, most employees indicate being uncomfortable in discussing mental health issues (over 75% of responses in almost all of the "No" or "I don't know" groups). 

Note that the "Not eligible for coverage" group does not fit neatly into the ordinal hierarchy of these variables, and was therefore excluded from further analysis. It is worth mentioning that as this option accounts for less than 5% of responses, it can be observed that a very small proportion of the sample may have reduced accessibility to mental healthcare as it pertains to employee/company benefits.

### 5.2.2 Plotting Awareness of Mental Health Options

The following variable "mh_options_aware" indicates whether respondents are aware as to what mental health options they have under their employer-provided mental health coverage.

```{r, fig.width = 15, fig.height = 10}
osmi_opt_com_cow <- osmi_comfort %>% 
  drop_na(mh_options_aware) %>% 
  ggplot(aes(x = mh_options_aware, y = after_stat(100*count/sum(count)), fill = comfort_coworker)) +
  geom_bar() +
  labs(x = "Aware of MH Options", y = "Percentage", fill = "", 
       title = "Comfort Discussing Mental Health with Coworker")
osmi_opt_com_cow

osmi_opt_sup <- osmi_comfort %>% 
  drop_na(mh_options_aware) %>% 
  ggplot(aes(x = mh_options_aware, y = after_stat(100*count/sum(count)), fill = comfort_supervisor)) +
  geom_bar() +
  labs(x = "Aware of MH Options", y = "Percentage", fill = "", 
       title = "Comfort Discussing MH with Supervisor")
osmi_opt_sup

grid.arrange(osmi_opt_com_cow,
             osmi_opt_sup,
             ncol = 2)
```

The data shows a similar pattern to that observed in Section 5.2.1. Respondents were more likely to be comfortable discussing mental health issues if they were aware of their mental healthcare options. Conversely, respondents who were not aware of their mental health options were less likely to be comfortable discussing mental health. Again, the "N/A" response was excluded for trend analysis and was simply provided for integrity's sake.

### 5.2.3 Plotting Employer's Active Involvment of Mental Health Awareness

The following variable "mh_employer_discuss" indicates whether the respondent's employer has ever formally discussed mental health, such as via official communications or through mental wellness campaigns. Just like Section 5.2.1, we used the *factor* function to order the categorical responses in a hierarchical structure to help with trend analysis.

```{r, fig.width = 15, fig.height = 10}
osmi_comfort$mh_employer_discuss <- factor(osmi_comfort$mh_employer_discuss, order = TRUE, 
                                           levels = c("No", "I don't know", "Yes"))

osmi_empdis_com_cow <- osmi_comfort %>% 
  drop_na(mh_employer_discuss) %>% 
  ggplot(aes(x = mh_employer_discuss, y = after_stat(100*count/sum(count)), fill = comfort_coworker)) +
  geom_bar() +
  labs(x = "Employer Discussed MH Formally", y = "Percentage", fill = "", 
       title = "Comfort Discussing Mental Health with Coworker")
osmi_empdis_com_cow


osmi_empdis_sup <- osmi_comfort %>% 
  drop_na(mh_employer_discuss) %>% 
  ggplot(aes(x = mh_employer_discuss, y = after_stat(100*count/sum(count)), fill = comfort_supervisor)) +
  geom_bar() +
  labs(x = "Employer Discussed MH Formally", y = "Percentage", fill = "", 
       title = "Comfort Discussing MH with Supervisor")
osmi_empdis_sup

grid.arrange(osmi_empdis_com_cow,
             osmi_empdis_sup,
             ncol = 2)
```

As with the previous Sections, respondents were more likely to be comfortable engaging in mental health topics with colleagues if their employer had formally brought up mental health at some point, and were less likely to be comfortable if their employer hadn't discussed mental health formally before.

### 5.2.4 Plotting Employer Offering Mental Health Resources

The variable "mh_resource_employer_offer" indicates whether the respondent's employer provides resources on learning more about mental health disorders and when to seek treatment. As with before, we use *factor* once again to order the categorical responses.

```{r, fig.width = 15, fig.height = 10}
osmi_comfort$mh_resource_employer_offer <- factor(osmi_comfort$mh_resource_employer_offer, order = TRUE, 
                                           levels = c("No", "I don't know", "Yes"))

osmi_resoff_com_cow <- osmi_comfort %>% 
  drop_na(mh_resource_employer_offer) %>% 
  ggplot(aes(x = mh_resource_employer_offer, after_stat(100*count/sum(count)), fill = comfort_coworker)) +
  geom_bar() +
  labs(x = "Employer Offered MH Resources", y = "Percentage", fill = "", 
       title = "Comfort Discussing Mental Health with Coworker")
osmi_resoff_com_cow

osmi_resoff_sup <- osmi_comfort %>% 
  drop_na(mh_resource_employer_offer) %>% 
  ggplot(aes(x = mh_resource_employer_offer, y = after_stat(100*count/sum(count)), fill = comfort_supervisor)) +
  geom_bar() +
  labs(x = "Employer Offered MH Resources", y = "Percentage", fill = "", 
       title = "Comfort Discussing MH with Supervisor")
osmi_resoff_sup

grid.arrange(osmi_resoff_com_cow,
             osmi_resoff_sup,
             ncol = 2)
```

The resulting trend is similar to the previous Sections, although the difference in responses are not as drastic. Overall, respondents were more likely to be comfortable discussing mental health issues if their employer offered mental health resources, and were less likely to be comfortable doing so if their employer did not offer mental health resources. Respondents who did not know if such resources were offered were more likely to uncertain as to whether they would be comfortable engaging colleagues in mental health topics (accounting for over 50% of responses in the "I don't know" group in the "Coworker" plot).


### 5.2.5 Plotting Anonymity Protection 

The following variable "anon_protect" indicates whether respondents remain anonymous if they chose to utilize mental health and/or substance abuse treatment resources provided by their employers.

```{r, fig.width = 15, fig.height = 10}
osmi_comfort$anon_protect <- factor(osmi_comfort$anon_protect, order = TRUE, 
                                           levels = c("No", "I don't know", "Yes"))

osmi_anon_com_cow <- osmi_comfort %>% 
  drop_na(anon_protect) %>% 
  ggplot(aes(x = anon_protect, y = after_stat(100*count/sum(count)), fill = comfort_coworker)) +
  geom_bar() +
  labs(x = "MH Resources Anonymity Protected", y = "Percentage", fill = "", 
       title = "Comfort Discussing Mental Health with Coworker")
osmi_anon_com_cow

osmi_anon_sup <- osmi_comfort %>% 
  drop_na(anon_protect) %>% 
  ggplot(aes(x = anon_protect, y = after_stat(100*count/sum(count)), fill = comfort_supervisor)) +
  geom_bar() +
  labs(x = "MH Resources Anonymity Protected", y = "Percentage", fill = "", 
       title = "Comfort Discussing MH with Supervisor")
osmi_anon_sup

grid.arrange(osmi_anon_com_cow,
             osmi_anon_sup,
             ncol = 2)
```

The data yielded trends that were similar to that of previous sections. Respondents who did not have their anonymity protected when seeking mental health resources were less likely to be comfortable discussing mental health topics with their coworkers or supervisors, but the opposite was true for respondents whose companies protected their identities when seeking mental healthcare. 

### 5.2.6 Plotting Perceived Difficulty Obtaining Mental Health Leave

The following variable, "mh_leave_difficulty" indicates whether respondents perceive obtaining mental health leave to be a trivial or difficult task. Unlike the previous variables, "mh_leave_difficulty" is a true ordinal variable, consisting of a range of answers ranging from "Very easy" to "Difficult" for a total of 5 different responses.

```{r}
osmi_comfort$mh_leave_difficulty <- factor(osmi_comfort$mh_leave_difficulty, order = TRUE, 
                                           levels = c("Very easy", "Somewhat easy", "I don't know", 
                                                      "Neither easy nor difficult", "Somewhat difficult", "Difficult"))

osmi_lea_com_cow <- osmi_comfort %>% 
  drop_na(mh_leave_difficulty) %>% 
  ggplot(aes(x = mh_leave_difficulty, y = after_stat(100*count/sum(count)), fill = comfort_coworker)) +
  geom_bar() +
  labs(x = "Difficulty Taking MH Leave", y = "Percentage", fill = "", title = "Comfort Discussing Mental Health with Coworker")
osmi_lea_com_cow

osmi_lea_sup <- osmi_comfort %>% 
  drop_na(mh_leave_difficulty) %>% 
  ggplot(aes(x = mh_leave_difficulty, y = after_stat(100*count/sum(count)), fill = comfort_supervisor)) +
  geom_bar() +
  labs(x = "Difficulty Taking MH Leave", y = "Percentage", fill = "", title = "Comfort Discussing MH with Supervisor")
osmi_lea_sup

grid.arrange(osmi_lea_com_cow,
             osmi_lea_sup,
             ncol = 2)
```

The data reflects a trend similar to the other workplace variables mentioned previously. The proportion of respondents comfortable discussing mental health issues with their colleagues (labelled blue in the plot) is significantly higher when difficultly taking mental health leave is perceived to be easier, and is significantly lower when taking leave is believed to be more difficult. An observation here is that with respondents who chose "I don't know", a majority of them are unsure about whether they are comfortable discussing mental health (labelled pink); more importantly, the proportion of respondents who picked "maybe" as to their comfort levels in this group are significantly larger than the rest of the other answers.

## 5.3 Summary of Plots

As with the previous Sections, we can use *grid.arrange* to combine all the plots together for presentation purposes.

```{r, fig.height = 30, fig.width = 11}
grid.arrange(osmi_cov_com_cow, osmi_cov_sup,
             osmi_opt_com_cow, osmi_opt_sup,
             osmi_empdis_com_cow, osmi_empdis_sup,
             osmi_resoff_com_cow, osmi_resoff_sup,
             osmi_anon_com_cow, osmi_anon_sup,
             osmi_lea_com_cow, osmi_lea_sup,
             ncol = 2)
```

## 5.4 Discussion

The data visualizations from this Section provide the most compelling picture about the relationship between workplace conditions and mental health related factors so far. Workplace variables, intended to indicate the degree to which tech companies value and provide mental health support for their employees, all appear to suggest a common trend with respect to interpersonal comfort discussing mental health among coworkers and supervisors. Specifically, whether companies provided mental health coverage; made employees explicitly aware of mental health options they could utilize; discussed mental health in a formal context; offered mental health resources to their employees; ensured the confidentiality of employees accessing mental health resources; and ensured employees did not find it difficult to obtain leave for mental health reasons; all indicate a pattern in respondents' responses with respect to their comfort in engaging in mental health discussion in the workplace setting. As the mental health resource in question became more accessible, respondents were more likely to be comfortable talking about mental health with coworkers and/or supervisors.

An interesting observation of the data visualizations is that there appears to be a pattern regarding undecided responses. In most of these plots, respondents who answered "I don't know" to any of the workplace variables (i.e., x-axis variable) were significantly more likely to answer "Maybe" (labelled pink on the plots) when asked how comfortable they were discussing mental health issues in the workplace compared to the other response groups. Combined with the general trend that was observed, this suggests that employees benefit from human resources teams taking the time to explain, in-depth, the mental health resources that are available to employees and how to access them.

The two main findings from this Section suggests that what mental health resources are available, as well as how employers communicate the availability of these resources to their employees, may impact whether those working in the tech industry are more comfortable discussing mental health topics with their peers or superiors, and perhaps consequently whether they opt to seek mental health treatment. In other words, a work culture that promotes openness with respect to mental health may lead to a more (mentally) healthier workforce.

A limitation of the data is that in most of these plots, there is at least one group with which there was a very small number of responses. For example, in the "MH Resources Anonymity Protected" plots, less than 5% of respondents answered "No". Using *nrow*, we can verify that there are a total of 27 responses in the data subset "osmi_comfort"; therefore, the aforementioned "No" responses accounts for only 1-2 respondents out of the entire sample, and is prone to anomalous results. Consequently, this weakens the reliability of our trend analyses above. Future research should aim to replicate these findings with a larger sample, before using correlational analyses to delve further into any patterns that may exist.

# 6. Conclusion and Recommendations

## 6.1 Summary of Findings

The following data analysis aimed to explore the responses gathered from the 2021 OSMI Mental Health in Tech Survey to identify trends and observations with regards to mental health in the workplace as well as the prevalence of mental health disorders in said industry's workforce. The exploratory nature of this analysis meant that a broader range of variables were covered in analysis and visualization, and the findings here are meant to provide preliminary information as a basis for future research objectives. The analysis was limited to American respondents only, yielding a sample size of 27 participants. It should be noted that the 2021 dataset had the least amount of data collected (n = 131) in OSMI's history, and thus resulted in a smaller-than-usual sample to analyze.

Analysis of the demographic data revealed that most respondents held tech-related roles at small-sized tech companies consisting of 25 or less employees. The majority of respondents were aged between 30-40 years old, and their gender identity were almost equally divided between males and females. Most respondents identified as Caucasian, a very slim proportion of respondents identified as multi-racial, and the rest of the sample consisted of Asian-identifying individuals. Respondents came from 16 different states, with a noticeable concentration of respondents residing in California.

Analysis of data related to the prevalence of mental health disorders revealed surprising trends in the sample. Over half of respondents reported currently or previously having been diagnosed with a mental health disorder. Of those diagnosed, over three quarters indicated having comorbid (i.e., multiple) mental health disorders simultaneously, with the rest indicating having a mood, psychotic, or stress disorder. The data suggests that prevalence rates of mental health disorders are exceptionally high in the tech industry as compared to the general public, such that disorders in tech companies are often the norm more often than not.

Analysis of data related to workplace related effects of mental health problems revealed a trend towards the perception that mental health disorders are more disruptive to work performance when left untreated, hinting at the importance of mental healthcare in workforce productivity. About 1 in 4 respondents were openly identified as struggling with a mental health disorder in their workplace, yet the majority of them believe that being identified as such did not have an impact on their careers. Despite this, most respondents felt that the tech industry and their employers provided only a moderate or weak level of mental health suppport, suggesting that there is room for improvement with regards to mental healthcare in tech companies. Lastly, there appeared to be no trend with regards to badly versus well handled mental health issues (i.e., witnessing a badly handled mental health issue does not appear to correlate with a reduction in observations of well handled ones), and the distribution of responses combined with the ambiguity of interpreting "unsure" responses make it difficult to make any remarks on said data.

Perhaps the most interesting findings were that of variables related to a company's mental healthcare comprehensiveness and how it was related to respondents' comfort in discussing mental health topics with their coworkers and/or supervisors. All the "workplace variables" plotted indicated a potential trend in respondents' comfortableness in discussing mental health issues with their colleagues; as mental health resources (e.g., mental health medical coverage) became more available and accessible (i.e., employees do not perceive significant difficulty in using such resources), respondents appeared more likely to be comfortable in engaging their colleagues with mental health topics. Being more open to employees about mental health issues (e.g., hosting mental health campaigns or talking about mental health in formal communications) also appears to help.

A significant limitation of the data is the small sample size. With a sample size of only 27 responses, this dataset does not meet the minimum criteria to satisfy the assumptions of the [Central Limit Theorem](https://en.wikipedia.org/wiki/Central_limit_theorem). As with most research in the social sciences, we assume that the data should usually be distributed normally. Because of this, this makes the reliability of our findings and conclusions questionable, and the small size by nature lends great uncertainty as to whether the data represents the population in question.

Another limitation is that some demographics were not represented in this dataset. For example, the dataset did not have any respondents who identified as African-American and/or Black. As with the previous limitation, a replicated study with a significantly larger sample size ought to resolve this issue, and oversampling methods can be utilized if necessary.

## 6.2 Recommendations

Based on our data analysis, several recommendations can be made regarding research and applied policy changes. First and foremost, the small sample size of our dataset means that a replication of this study is highly recommended before implementing any of the recommendations that will be listed out below. Replicating the survey with a larger sample size will improve the reliability and validity of our data and lend greater support to our findings and conclusions. It will also allow us to determine whether any of our observations were due to anomalous results.

The strongest trend indicated by our data is that one's level of comfort discussing mental health may be influenced by the level of mental health support that is provided by employers. We recommend that future research can focus into this area, such as utilizing longitudinal research methods to determine whether implementing mental health awareness programs and including mental health coverage in medical benefits for employees can improve the well-being of workers in the tech industry. Since our findings also suggested that employees perceive mental health disorders to disrupt productivity when left untreated, another line of related research would be to determine the improvement (if it exists) in work performance of employees with mental health disorders after a period of mental health treatment. Together, these lines of research may allow us to posit whether providing mental health support to employees, just like physical health support, can improve the health of not just workers, but also improve overall work efficiency within a tech company.

Prevalence data suggests that the occurrence of mental health disorders in the tech industry may be significantly higher than of that seen in the general public. Therefore, future research could investigate what unique factors in said field (e.g., work setting, work hours, nature of work) may be influencing the higher rate of mental disorders observed. The findings from such research could inform clinical personnel (e.g., psychologists) about specific signs, symptoms, and/or lifestyle factors that may be maintaining one's mental disorder, allowing for more effective treatment.

Finally, future research could benefit from use of regression analyses to identify which variables may predict, and to what extent, the occurrence of a mental health disorder. For example, using a [generalized linear model](https://en.wikipedia.org/wiki/Generalized_linear_model) to provide further insight into what proportion of variance can be accounted for by the specific variables inputted, and which variables may have greater power in explaining for the observed phenomena.

With respect to policy or applied recommendations, several suggestions can be made and would be supported by future research topics mentioned above. First, we recommend tech companies to be more transparent to employees about mental health issues. Discussing mental health topics in a formal setting and promoting mental health awareness in the workplace may make employees more educated and less hesitant in seeking treatment or help when required, rather than hiding such issues from their employers which could potentially hinder productivity and treatment. Second, employers should be more inclusive in employees' medical benefits (i.e., providing comprehensive physical **and ** mental health coverage), as it can indirectly improve the company's profitability in the long run via improved workforce efficiency. Finally, employers should take care in handling mental health issues in the workplace, as how such issues are handled may affect employees' willingness to divulge their mental health problems to employers and/or treatment providers, prolonging their suffering; that said, there is less data to support this recommendation and observation and/or data collection by human resource teams may lend greater insight into the effectiveness of this policy recommendation.